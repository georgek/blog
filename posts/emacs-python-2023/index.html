<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>My 2023 Emacs Python Setup | gpk blog</title><meta name=keywords content="programming,emacs,python"><meta name=description content="My new configuration with Emacs 29, Eglot, python-lsp-server and tree-sitter"><meta name=author content="George Kettleborough"><link rel=canonical href=https://georgek.github.io/blog/posts/emacs-python-2023/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.10e88de24220944ec273601e195da7ce961cf5eb6e1e99c4de1d72417f33f98a.css integrity="sha256-EOiN4kIglE7Cc2AeGV2nzpYc9etuHpnE3h1yQX8z+Yo=" rel="preload stylesheet" as=style><link rel=icon href=https://georgek.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://georgek.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://georgek.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://georgek.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://georgek.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta name=google-site-verification content="0kCOfXcz_aAJKh_eZglpQdpUUfE2IqecYZesW3oUOJo"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Lora:ital@0;1&family=Vollkorn:ital,wght@0,800;1,800&display=swap" rel=stylesheet><meta property="og:title" content="My 2023 Emacs Python Setup"><meta property="og:description" content="My new configuration with Emacs 29, Eglot, python-lsp-server and tree-sitter"><meta property="og:type" content="article"><meta property="og:url" content="https://georgek.github.io/blog/posts/emacs-python-2023/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-15T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-15T00:00:00+00:00"><meta property="og:site_name" content="gpk blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="My 2023 Emacs Python Setup"><meta name=twitter:description content="My new configuration with Emacs 29, Eglot, python-lsp-server and tree-sitter"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://georgek.github.io/blog/posts/"},{"@type":"ListItem","position":2,"name":"My 2023 Emacs Python Setup","item":"https://georgek.github.io/blog/posts/emacs-python-2023/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"My 2023 Emacs Python Setup","name":"My 2023 Emacs Python Setup","description":"My new configuration with Emacs 29, Eglot, python-lsp-server and tree-sitter","keywords":["programming","emacs","python"],"articleBody":" I've been using Emacs for almost 15 years now. Somewhat surprisingly, I hadn't touched my config in three years! It's been working that well. But now that Emacs 29 has been released I've decided to take a look at what's new and there have been some big changes, particularly for Python.\nGoodbye Elpy, Goodbye Projectile Elpy has been the primary mode for Python development for me for years now. But sadly, it looks like the project is no more. The good news is there are better ways to do what it did. It's bittersweet to say goodbye to it and I will be eternally grateful to the authors, but progress is progress.\nSimilarly, Projectile was what I used to manage projects. But now Emacs has project.el built in and I've opted to use that instead. One nice thing about project.el is it uses other standard stuff underneath like xref. I configured xref to use Ripgrep and now the Project commands like C-x p g use Ripgrep:\n1 2 3 (use-package xref :config (setq xref-search-program 'ripgrep)) Native builds and tree-sitter I always build Emacs myself from source if I can. I run Gentoo on my personal computer so that goes without saying, but I do it on Ubuntu too, if only to get the latest versions. This does mean I can easily enable a couple of new features: native builds and tree-sitter.\nOn Gentoo this was a simple as adding a couple of USE flags to portage. My USE flags for emacs now look like:\n1 app-editors/emacs athena cairo gui gtk harfbuzz json libxml2 source tree-sitter jit -X The gtk -X also implies a pgtk build which is nice because I use wayland (sway).\nOn Ubuntu (20.04, yeah, old, this is one reason I prefer rolling distros) it was more difficult. I first pulled the source code (emacs-29.1.tar.gz) from a nearby GNU mirror per the GNU website. Then a few packages are required (I use i3/X11 on Ubuntu):\n1 2 3 4 sudo apt install autoconf make gcc texinfo libgtk-3-dev libxpm-dev libjpeg-dev \\ libgif-dev libtiff5-dev libgnutls28-dev libncurses5-dev libjansson-dev \\ libharfbuzz-dev libharfbuzz-bin imagemagick libmagickwand-dev libgccjit-10-dev \\ libgccjit0 gcc-10 libjansson4 libjansson-dev xaw3dg-dev texinfo libx11-dev Now, because libgccjit (required for native builds) is only for GCC 10, the build process has to be configured for GCC 10 specifically, in addition to enabling all the wanted features:\n1 2 3 4 5 CC=\"gcc-10\" ./configure --prefix=$HOME --with-json --with-native-compilation=aot \\ --with-modules --with-compress-install --with-threads --with-included-regex \\ --with-x-toolkit=lucid --with-zlib --with-jpeg --with-png --with-imagemagick \\ --with-tiff --with-xpm --with-gnutls --with-xft --with-xml2 --with-mailutils \\ --with-tree-sitter Note that I keep my own builds in $HOME by setting --prefix. By default the installation would put it in the system directories which I prefer not to do as those are controlled by my system package manager. Also note that I set --with-native-compilation=aot which makes native builds ahead of time instead of JIT compiling them. Run ./configure --help to see all of the build options.\nThen I just compiled it:\n1 make -j 8 # 8 threads The build can be tested with src/emacs -Q then, if it works:\n1 make install Eglot Elpy provided a proper IDE experience for Python but it did it in a completely custom, albeit very clever, way via a special RPC process which used jedi. Now with LSP we can get essentially the same sort of thing but in a more standard way that works with all languages.\nI have tried LSP (in particular, lsp-mode) in emacs before, but I wasn't impressed. I cannot stand latency and the moment I detect latency when merely typing in a text editor, I walk away. But I'm pleased to say that with Emacs 29, native builds, Eglot and python-lsp-server it is now fast enough for me. lsp-mode might very well be fast enough now too. I'll probably try it eventually.\nI installed python-lsp-server (with pipx on Ubuntu). This is my preferred way of installing Python apps if they're not available in the base distro. Notice how there will be only one LSP server installed for my whole system (not one per virtualenv).\nEnabling Eglot is easy. To make it work for Python it just needs the following:\n1 2 (use-package eglot :hook (python-mode . eglot-ensure)) Now just open a Python file and it should work. It does everything Elpy did (or, at least, what I used it for) and more. Just like that.\nBy default, Eglot uses Flymake. I had previously been using Flycheck. I can't really remember why, to be honest, so I'll try using Flymake instead and say goodbye to Flycheck for now too.\nVirtualenvs OK, so, it doesn't completely just work. One of the most important things for me is being able to jump to the definition of a symbol in the source. This does just work for first party stuff and (kinda) for standard library stuff, but it won't work for third party stuff. That's because the LSP server does know where to find those libraries.\nUsually when developing on a Python project one would create a virtual environment for it. I make everything a package such that doing a pip install -e . installs the package and all of its dependencies into the virtualenv. Then you just need to make the LSP server aware of this environment.\nI used to use virtualenvwrapper to create virtualenvs for each project, but I've found a better way: direnv. This allows you to create .envrc files in directories with anything you want in it then automatically loads it into your environment when you change to that directory. What's even neater is it has built-in support for Python (and other languages).\nTo install direnv on Gentoo I used the Guru overlay:\n1 eselect repository enable guru After installing and setting up direnv, make a file called .envrc at the top of your project and put the following:\n1 layout python That's it! After enabling your project for direnv support it will automatically create a virtualenv and activate it. When you change directory, it will deactivate it. Amazing!\nIn Emacs you can install the direnv package and enable it:\n1 2 3 (use-package direnv :config (direnv-mode)) Now when you browse to a project with a .envrc file it will just work.\nTree-sitter Finally, to enable tree-sitter I needed to first install the grammar for Python, I added the following to my emacs config:\n1 2 (setq treesit-language-source-alist '((python \"https://github.com/tree-sitter/tree-sitter-python\"))) And then (after evaling the above) you can run: M-x treesit-install-language-grammar. This builds the grammar for you and puts it in your emacs config.\nNow you can use the mode python-ts-mode instead of python-mode:\n1 2 3 4 (use-package python :mode (\"\\\\.py\\\\'\" . python-ts-mode) :init (add-to-list 'major-mode-remap-alist '(python-mode . python-ts-mode))) The major-mode-remap-list entry means python-ts-mode will be used whenever python-mode would have been used, like when opening a script with no file extension but a Python shebang.\nCompletion One thing I cannot do without is some kind of completion capability. In bash I use tab-completion extensively and I consider any keyboard-driven software that doesn't support at least tab-completion to be defective.\nBasic completion is supported in Emacs out of the box but it can be extended to be quite sophisticated. But I've always found it a bit overwhelming. My life was changed when I first enabled ido. The combination of completion and narrowing is amazing. Later I switched to other packages like ivy, Helm and Selectrum and enabled in-buffer completion with Company. Selectrum is now defunct and replaced with Vertico.\nFor the first time, I have a completion set up that I understand and that I'm very happy with.\nWhat I really wanted was fuzzy-style completion in minibuffer contexts but dead basic prefix-style completion within buffers. I also want the completion within-buffer to be driven by the tab key like in a bash shell. I've settled on Company within-buffer and Vertico in the minibuffer.\nI like the setting (setq tab-always-indent 'complete) which causes TAB to indent first, then complete, but I was getting weird behaviour where that completion would not launch company. So instead:\n1 (global-set-key (kbd \"TAB\") #'company-indent-or-complete-common) This now does the right thing but launches Company instead of the default completion function.\nThe other major part is completion styles. I like the Orderless style for the fuzzy minibuffer style, but it doesn't work for basic completion. Emacs supports setting a list of completion styles by setting completion-styles and further refining that for specific categories by setting completion-category-overrides. The trouble is, the category names for the latter are quite hard to find. But eventually I settled on the following configuration:\n1 2 3 4 5 6 7 (use-package orderless :init (setq completion-styles '(basic partial-completion orderless) completion-category-defaults nil completion-category-overrides '((project-file (styles orderless)) (buffer (styles orderless)) (command (styles orderless))))) This sets basic and partial-completion styles first by default everywhere. Company doesn't really support the Orderless style, which is fine by me as I don't want it in-buffer anyway. I then override it for particular categories to add orderless to the front. project-file is for finding files in projects with C-x p f, buffer is for switching buffers and command is for running commands with M-x.\nConclusion To sum up, I've switched from Projectile to project.el, from Elpy to Eglot/LSP and from virtualenvwrapper to direnv as well as including the latest improvements like native builds and tree-sitter. This has really simplified my config and I seem to have a renewed love for Emacs.\nI've been using this configuration for a few days now for real work and I really love it so far. Things like the eldoc and xref jump to definition features are working perfectly now and I've had real trouble with consistent behaviour before.\nMy actual emacs config does include a number of extra tweaks to all of this stuff. I love reading other people's .emacs files, so maybe you'll enjoy reading mine too: https://github.com/georgek/dot-emacs\nHappy hacking!\n","wordCount":"1641","inLanguage":"en","datePublished":"2023-08-15T00:00:00Z","dateModified":"2023-08-15T00:00:00Z","author":{"@type":"Person","name":"George Kettleborough"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://georgek.github.io/blog/posts/emacs-python-2023/"},"publisher":{"@type":"Organization","name":"gpk blog","logo":{"@type":"ImageObject","url":"https://georgek.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://georgek.github.io/blog/ accesskey=h title="gpk blog (Alt + H)">gpk blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://georgek.github.io/blog/categories/ title=categories><span>categories</span></a></li><li><a href=https://georgek.github.io/blog/tags/ title=tags><span>tags</span></a></li><li><a href=https://georgek.github.io/blog/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://georgek.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://georgek.github.io/blog/posts/>Posts</a></div><h1 class=post-title>My 2023 Emacs Python Setup</h1><div class=post-description>My new configuration with Emacs 29, Eglot, python-lsp-server and tree-sitter</div><div class=post-meta><span title='2023-08-15 00:00:00 +0000 UTC'>15 August 2023</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;George Kettleborough</div></header><div class=post-content><p>I've been using Emacs for almost 15 years now. Somewhat surprisingly, I hadn't touched
my config in three years! It's been working that well. But now that Emacs 29 has been
released I've decided to take a look at what's new and there have been some big changes,
particularly for Python.</p><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>Goodbye Elpy, Goodbye Projectile</h2><div id=outline-text-headline-1 class=outline-text-2><p><a href=https://github.com/jorgenschaefer/elpy/>Elpy</a> has been the primary mode for Python development for me for years now. But sadly,
it looks like the project is no more. The good news is there are better ways to do what
it did. It's bittersweet to say goodbye to it and I will be eternally grateful to the
authors, but progress is progress.</p><p>Similarly, <a href=https://github.com/bbatsov/projectile>Projectile</a> was what I used to manage projects. But now Emacs has project.el
built in and I've opted to use that instead. One nice thing about project.el is it uses
other standard stuff underneath like xref. I configured xref to use <a href=https://github.com/BurntSushi/ripgrep>Ripgrep</a> and now the
Project commands like <code>C-x p g</code> use Ripgrep:</p><div class="src src-elisp"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp><span style=display:flex><span>(<span style=color:#b58900>use-package</span> <span style=color:#268bd2>xref</span>
</span></span><span style=display:flex><span>  <span style=color:#b58900>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#b58900>setq</span> <span style=color:#268bd2>xref-search-program</span> <span style=color:#2aa198>&#39;ripgrep</span>))</span></span></code></pre></td></tr></table></div></div></div></div></div><div id=outline-container-headline-2 class=outline-2><h2 id=headline-2>Native builds and tree-sitter</h2><div id=outline-text-headline-2 class=outline-text-2><p>I always build Emacs myself from source if I can. I run Gentoo on my personal computer
so that goes without saying, but I do it on Ubuntu too, if only to get the latest
versions. This does mean I can easily enable a couple of new features: native builds
and tree-sitter.</p><p>On Gentoo this was a simple as adding a couple of USE flags to portage. My USE flags
for emacs now look like:</p><div class="src src-text"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>app-editors/emacs athena cairo gui gtk harfbuzz json libxml2 source tree-sitter jit -X</span></span></code></pre></td></tr></table></div></div></div><p>The <code>gtk -X</code> also implies a <code>pgtk</code> build which is nice because I use wayland (sway).</p><p>On Ubuntu (20.04, yeah, old, this is one reason I prefer rolling distros) it was more
difficult. I first pulled the source code (<code>emacs-29.1.tar.gz</code>) from a <a href=http://ftpmirror.gnu.org/emacs/>nearby GNU
mirror</a> per the <a href=https://www.gnu.org/software/emacs/download.html>GNU website</a>. Then a few packages are required (I use i3/X11 on
Ubuntu):</p><div class="src src-bash"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install autoconf make gcc texinfo libgtk-3-dev libxpm-dev libjpeg-dev <span style=color:#cb4b16>\
</span></span></span><span style=display:flex><span><span style=color:#cb4b16></span>     libgif-dev libtiff5-dev libgnutls28-dev libncurses5-dev libjansson-dev <span style=color:#cb4b16>\
</span></span></span><span style=display:flex><span><span style=color:#cb4b16></span>     libharfbuzz-dev libharfbuzz-bin imagemagick libmagickwand-dev libgccjit-10-dev <span style=color:#cb4b16>\
</span></span></span><span style=display:flex><span><span style=color:#cb4b16></span>     libgccjit0 gcc-10 libjansson4 libjansson-dev xaw3dg-dev texinfo libx11-dev</span></span></code></pre></td></tr></table></div></div></div><p>Now, because <code>libgccjit</code> (required for native builds) is only for GCC 10, the build
process has to be configured for GCC 10 specifically, in addition to enabling all the
wanted features:</p><div class="src src-bash"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#268bd2>CC</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;gcc-10&#34;</span> ./configure --prefix<span style=color:#719e07>=</span><span style=color:#268bd2>$HOME</span> --with-json --with-native-compilation<span style=color:#719e07>=</span>aot <span style=color:#cb4b16>\
</span></span></span><span style=display:flex><span><span style=color:#cb4b16></span>  --with-modules --with-compress-install --with-threads --with-included-regex <span style=color:#cb4b16>\
</span></span></span><span style=display:flex><span><span style=color:#cb4b16></span>  --with-x-toolkit<span style=color:#719e07>=</span>lucid --with-zlib --with-jpeg --with-png --with-imagemagick <span style=color:#cb4b16>\
</span></span></span><span style=display:flex><span><span style=color:#cb4b16></span>  --with-tiff --with-xpm --with-gnutls --with-xft --with-xml2 --with-mailutils <span style=color:#cb4b16>\
</span></span></span><span style=display:flex><span><span style=color:#cb4b16></span>  --with-tree-sitter</span></span></code></pre></td></tr></table></div></div></div><p>Note that I keep my own builds in <code>$HOME</code> by setting <code>--prefix</code>. By default the
installation would put it in the system directories which I prefer not to do as those
are controlled by my system package manager. Also note that I set
<code>--with-native-compilation=aot</code> which makes native builds ahead of time instead of JIT
compiling them. Run <code>./configure --help</code> to see all of the build options.</p><p>Then I just compiled it:</p><div class="src src-bash"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make -j <span style=color:#2aa198>8</span>                       <span style=color:#586e75># 8 threads</span></span></span></code></pre></td></tr></table></div></div></div><p>The build can be tested with <code>src/emacs -Q</code> then, if it works:</p><div class="src src-bash"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make install</span></span></code></pre></td></tr></table></div></div></div></div></div><div id=outline-container-headline-3 class=outline-2><h2 id=headline-3>Eglot</h2><div id=outline-text-headline-3 class=outline-text-2><p>Elpy provided a proper IDE experience for Python but it did it in a completely custom,
albeit very clever, way via a special RPC process which used <code>jedi</code>. Now with LSP we
can get essentially the same sort of thing but in a more standard way that works with
all languages.</p><p>I have tried LSP (in particular, <a href=https://emacs-lsp.github.io/lsp-mode/><code>lsp-mode</code></a>) in emacs before, but I wasn't impressed. I
cannot stand latency and the moment I detect latency when merely typing in a text
editor, I walk away. But I'm pleased to say that with Emacs 29, native builds, Eglot
and <a href=https://github.com/python-lsp/python-lsp-server><code>python-lsp-server</code></a> it is now fast enough for me. <code>lsp-mode</code> might very well be
fast enough now too. I'll probably try it eventually.</p><p>I installed <code>python-lsp-server</code> (with <a href=https://github.com/pypa/pipx><code>pipx</code></a> on Ubuntu). This is my preferred way of
installing Python apps if they're not available in the base distro. Notice how there
will be only one LSP server installed for my whole system (not one per virtualenv).</p><p>Enabling Eglot is easy. To make it work for Python it just needs the following:</p><div class="src src-elisp"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp><span style=display:flex><span>(<span style=color:#b58900>use-package</span> <span style=color:#268bd2>eglot</span>
</span></span><span style=display:flex><span>  <span style=color:#b58900>:hook</span> (<span style=color:#268bd2>python-mode</span> <span style=color:#719e07>.</span> <span style=color:#268bd2>eglot-ensure</span>))</span></span></code></pre></td></tr></table></div></div></div><p>Now just open a Python file and it should work. It does everything Elpy did (or, at
least, what I used it for) and more. Just like that.</p><p>By default, Eglot uses Flymake. I had previously been using Flycheck. I can't really
remember why, to be honest, so I'll try using Flymake instead and say goodbye to
Flycheck for now too.</p></div></div><div id=outline-container-headline-4 class=outline-2><h2 id=headline-4>Virtualenvs</h2><div id=outline-text-headline-4 class=outline-text-2><p>OK, so, it doesn't completely just work. One of the most important things for me is
being able to jump to the definition of a symbol in the source. This does just work
for first party stuff and (kinda) for standard library stuff, but it won't work for
third party stuff. That's because the LSP server does know where to find those
libraries.</p><p>Usually when developing on a Python project one would create a virtual environment for
it. I make everything a package such that doing a <code>pip install -e .</code> installs the
package and all of its dependencies into the virtualenv. Then you just need to make the
LSP server aware of this environment.</p><p>I used to use <code>virtualenvwrapper</code> to create virtualenvs for each project, but I've found
a better way: <a href=https://direnv.net/><code>direnv</code></a>. This allows you to create <code>.envrc</code> files in directories with
anything you want in it then automatically loads it into your environment when you
change to that directory. What's even neater is it has built-in support for Python (and
other languages).</p><p>To install <code>direnv</code> on Gentoo I used the <a href=https://github.com/gentoo-mirror/guru>Guru</a> overlay:</p><div class="src src-bash"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>eselect repository <span style=color:#b58900>enable</span> guru</span></span></code></pre></td></tr></table></div></div></div><p>After installing and setting up <code>direnv</code>, make a file called <code>.envrc</code> at the top of your
project and put the following:</p><div class="src src-bash"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>layout python</span></span></code></pre></td></tr></table></div></div></div><p>That's it! After enabling your project for <code>direnv</code> support it will automatically
create a virtualenv and activate it. When you change directory, it will deactivate it.
Amazing!</p><p>In Emacs you can install the <code>direnv</code> package and enable it:</p><div class="src src-elisp"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp><span style=display:flex><span>(<span style=color:#b58900>use-package</span> <span style=color:#268bd2>direnv</span>
</span></span><span style=display:flex><span>  <span style=color:#b58900>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#268bd2>direnv-mode</span>))</span></span></code></pre></td></tr></table></div></div></div><p>Now when you browse to a project with a <code>.envrc</code> file it will just work.</p></div></div><div id=outline-container-headline-5 class=outline-2><h2 id=headline-5>Tree-sitter</h2><div id=outline-text-headline-5 class=outline-text-2><p>Finally, to enable tree-sitter I needed to first install the grammar for Python, I added
the following to my emacs config:</p><div class="src src-elisp"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp><span style=display:flex><span>(<span style=color:#b58900>setq</span> <span style=color:#268bd2>treesit-language-source-alist</span>
</span></span><span style=display:flex><span>   <span style=color:#719e07>&#39;</span>((<span style=color:#268bd2>python</span> <span style=color:#2aa198>&#34;https://github.com/tree-sitter/tree-sitter-python&#34;</span>)))</span></span></code></pre></td></tr></table></div></div></div><p>And then (after evaling the above) you can run: <code>M-x treesit-install-language-grammar</code>.
This builds the grammar for you and puts it in your emacs config.</p><p>Now you can use the mode <code>python-ts-mode</code> instead of <code>python-mode</code>:</p><div class="src src-elisp"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp><span style=display:flex><span>(<span style=color:#b58900>use-package</span> <span style=color:#268bd2>python</span>
</span></span><span style=display:flex><span>  <span style=color:#b58900>:mode</span> (<span style=color:#2aa198>&#34;\\.py\\&#39;&#34;</span> <span style=color:#719e07>.</span> <span style=color:#268bd2>python-ts-mode</span>)
</span></span><span style=display:flex><span>  <span style=color:#b58900>:init</span>
</span></span><span style=display:flex><span>  (<span style=color:#268bd2>add-to-list</span> <span style=color:#2aa198>&#39;major-mode-remap-alist</span> <span style=color:#719e07>&#39;</span>(<span style=color:#268bd2>python-mode</span> <span style=color:#719e07>.</span> <span style=color:#268bd2>python-ts-mode</span>)))</span></span></code></pre></td></tr></table></div></div></div><p>The <code>major-mode-remap-list</code> entry means <code>python-ts-mode</code> will be used whenever
<code>python-mode</code> would have been used, like when opening a script with no file extension
but a Python shebang.</p></div></div><div id=outline-container-headline-6 class=outline-2><h2 id=headline-6>Completion</h2><div id=outline-text-headline-6 class=outline-text-2><p>One thing I cannot do without is some kind of completion capability. In bash I use
tab-completion extensively and I consider any keyboard-driven software that doesn't
support at least tab-completion to be defective.</p><p>Basic completion is supported in Emacs out of the box but it can be extended to be quite
sophisticated. But I've always found it a bit overwhelming. My life was changed when I
first enabled <a href=https://www.gnu.org/software/emacs/manual/html_mono/ido.html>ido</a>. The combination of completion and narrowing is amazing. Later I
switched to other packages like <a href=https://github.com/abo-abo/swiper>ivy</a>, <a href=https://emacs-helm.github.io/helm/>Helm</a> and <a href=https://github.com/radian-software/selectrum>Selectrum</a> and enabled in-buffer completion
with <a href=https://company-mode.github.io/>Company</a>. Selectrum is now defunct and replaced with <a href=https://github.com/minad/vertico>Vertico</a>.</p><p>For the first time, I have a completion set up that I understand and that I'm very happy
with.</p><p>What I really wanted was fuzzy-style completion in minibuffer contexts but dead basic
prefix-style completion within buffers. I also want the completion within-buffer to be
driven by the tab key like in a bash shell. I've settled on Company within-buffer and
Vertico in the minibuffer.</p><p>I like the setting <code>(setq tab-always-indent 'complete)</code> which causes TAB to indent
first, then complete, but I was getting weird behaviour where that completion would not
launch company. So instead:</p><div class="src src-elisp"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp><span style=display:flex><span>(<span style=color:#268bd2>global-set-key</span> (<span style=color:#268bd2>kbd</span> <span style=color:#2aa198>&#34;TAB&#34;</span>) <span style=color:#268bd2>#&#39;</span><span style=color:#268bd2>company-indent-or-complete-common</span>)</span></span></code></pre></td></tr></table></div></div></div><p>This now does the right thing but launches Company instead of the default completion
function.</p><p>The other major part is completion styles. I like the <a href=https://github.com/oantolin/orderless>Orderless</a> style for the fuzzy
minibuffer style, but it doesn't work for basic completion. Emacs supports setting a
list of completion styles by setting <code>completion-styles</code> and further refining that for
specific categories by setting <code>completion-category-overrides</code>. The trouble is, the
category names for the latter are quite hard to find. But eventually I settled on the
following configuration:</p><div class="src src-elisp"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp><span style=display:flex><span>(<span style=color:#b58900>use-package</span> <span style=color:#268bd2>orderless</span>
</span></span><span style=display:flex><span>  <span style=color:#b58900>:init</span>
</span></span><span style=display:flex><span>  (<span style=color:#b58900>setq</span> <span style=color:#268bd2>completion-styles</span> <span style=color:#719e07>&#39;</span>(<span style=color:#268bd2>basic</span> <span style=color:#268bd2>partial-completion</span> <span style=color:#268bd2>orderless</span>)
</span></span><span style=display:flex><span>        <span style=color:#268bd2>completion-category-defaults</span> <span style=color:#cb4b16>nil</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>completion-category-overrides</span> <span style=color:#719e07>&#39;</span>((<span style=color:#268bd2>project-file</span> (<span style=color:#268bd2>styles</span> <span style=color:#268bd2>orderless</span>))
</span></span><span style=display:flex><span>                                        (<span style=color:#268bd2>buffer</span> (<span style=color:#268bd2>styles</span> <span style=color:#268bd2>orderless</span>))
</span></span><span style=display:flex><span>                                        (<span style=color:#268bd2>command</span> (<span style=color:#268bd2>styles</span> <span style=color:#268bd2>orderless</span>)))))</span></span></code></pre></td></tr></table></div></div></div><p>This sets <code>basic</code> and <code>partial-completion</code> styles first by default everywhere. Company
doesn't really support the Orderless style, which is fine by me as I don't want it
in-buffer anyway. I then override it for particular categories to add <code>orderless</code> to
the front. <code>project-file</code> is for finding files in projects with <code>C-x p f</code>, <code>buffer</code> is
for switching buffers and <code>command</code> is for running commands with <code>M-x</code>.</p></div></div><div id=outline-container-headline-7 class=outline-2><h2 id=headline-7>Conclusion</h2><div id=outline-text-headline-7 class=outline-text-2><p>To sum up, I've switched from Projectile to project.el, from Elpy to Eglot/LSP and from
virtualenvwrapper to direnv as well as including the latest improvements like native
builds and tree-sitter. This has really simplified my config and I seem to have a
renewed love for Emacs.</p><p>I've been using this configuration for a few days now for real work and I really love it
so far. Things like the eldoc and xref jump to definition features are working
perfectly now and I've had real trouble with consistent behaviour before.</p><p>My actual emacs config does include a number of extra tweaks to all of this stuff. I
love reading other people's .emacs files, so maybe you'll enjoy reading mine too:
<a href=https://github.com/georgek/dot-emacs>https://github.com/georgek/dot-emacs</a></p><p>Happy hacking!</p></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://georgek.github.io/blog/tags/programming/>programming</a></li><li><a href=https://georgek.github.io/blog/tags/emacs/>emacs</a></li><li><a href=https://georgek.github.io/blog/tags/python/>python</a></li></ul><nav class=paginav><a class=prev href=https://georgek.github.io/blog/posts/emacs-regexp-replace/><span class=title>« Prev</span><br><span>Replacing Strings in an Entire Project</span></a>
<a class=next href=https://georgek.github.io/blog/posts/calibre-rootless-install/><span class=title>Next »</span><br><span>Install Calibre without Root</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share My 2023 Emacs Python Setup on twitter" href="https://twitter.com/intent/tweet/?text=My%202023%20Emacs%20Python%20Setup&amp;url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2femacs-python-2023%2f&amp;hashtags=programming%2cemacs%2cpython"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share My 2023 Emacs Python Setup on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2femacs-python-2023%2f&amp;title=My%202023%20Emacs%20Python%20Setup&amp;summary=My%202023%20Emacs%20Python%20Setup&amp;source=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2femacs-python-2023%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share My 2023 Emacs Python Setup on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2femacs-python-2023%2f&title=My%202023%20Emacs%20Python%20Setup"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share My 2023 Emacs Python Setup on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2femacs-python-2023%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share My 2023 Emacs Python Setup on whatsapp" href="https://api.whatsapp.com/send?text=My%202023%20Emacs%20Python%20Setup%20-%20https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2femacs-python-2023%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share My 2023 Emacs Python Setup on telegram" href="https://telegram.me/share/url?text=My%202023%20Emacs%20Python%20Setup&amp;url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2femacs-python-2023%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://georgek.github.io/blog/>gpk blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>