<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Cooking with Make | gpk blog</title><meta name=keywords content="cooking,programming,make,makefile,declarative"><meta name=description content="In which I compare cooking food with building software"><meta name=author content="George Kettleborough"><link rel=canonical href=https://georgek.github.io/blog/posts/cooking-with-make/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.9be4cbf38947dd1889b081e3b3ef750f455a2947f8dafbba33625b4fefc806fe.css integrity="sha256-m+TL84lH3RiJsIHjs+91D0VaKUf42vu6M2JbT+/IBv4=" rel="preload stylesheet" as=style><link rel=icon href=https://georgek.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://georgek.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://georgek.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://georgek.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://georgek.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta name=google-site-verification content="0kCOfXcz_aAJKh_eZglpQdpUUfE2IqecYZesW3oUOJo"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Lora:ital@0;1&family=Vollkorn:ital,wght@0,800;1,800&display=swap" rel=stylesheet><meta property="og:title" content="Cooking with Make"><meta property="og:description" content="In which I compare cooking food with building software"><meta property="og:type" content="article"><meta property="og:url" content="https://georgek.github.io/blog/posts/cooking-with-make/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-03T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-03T00:00:00+00:00"><meta property="og:site_name" content="gpk blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Cooking with Make"><meta name=twitter:description content="In which I compare cooking food with building software"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://georgek.github.io/blog/posts/"},{"@type":"ListItem","position":2,"name":"Cooking with Make","item":"https://georgek.github.io/blog/posts/cooking-with-make/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Cooking with Make","name":"Cooking with Make","description":"In which I compare cooking food with building software","keywords":["cooking","programming","make","makefile","declarative"],"articleBody":"I cook a lot of food from scratch and it occurred to me one day that the way I understand and assimilate recipes is very similar to how make works.\nSo, in case you don’t know, make is a tool used to build executable software from source code. Building software often involves several steps such as translation, compilation, linking and bundling. The process required for a particular project is describe in a Makefile but, here’s the thing, it isn’t described imperatively, it’s described declaratively.\nLet’s look at an example:\n1 2 myprogram: code.c gcc code.c -o myprogram In the example myprogram is a target and code.c is a prerequisite. The target is what make is going to, well, make. The prerequisite is what is required before we can make it. In this case, the prerequisite is source code, so is always present and satisfied.\nThe second line tells make how to make the target from the prerequisite (OK, this bit is imperative, but we have to do something). In this case, we run a C compiler.\nIn this second example, more than one step is required to build the target:\n1 2 3 4 5 myprogram: module.o gcc module.o -o myprogram module.o: module.c gcc -c module.c -o module.o Now we first require module.o and, in case it’s not already present, we show how to make module.o too which requires module.c, the source code.\nMaking food So what does a food recipe look like in a Makefile? Here’s how to make a basic béchamel sauce:\n1 2 3 4 5 béchamel: milk roux Gradually incorporate milk into roux, whisking continuously roux: butter flour Combine equal parts melted butter and flour into smooth paste We could easily extend this file to include higher-level targets, like a Mornay sauce:\n1 2 mornay: béchamel grated-cheese Add grated cheese to warm sauce More complex recipes are then natural:\n1 2 3 4 5 cauliflower-cheese: mornay boiled-cauliflower Combine sauce and boiled cauliflower boilded-cauliflower: cauliflower Separate cauliflower and boil in salted water Implicit rules A perhaps lesser-known feature of make is that it contains implicit rules. That is, make already knows how to make some things, mostly around C compilation. These aren’t as often used today, probably because C is no longer the only language in town.\n1 module: module.o This is a valid Makefile. This works because make already knows how to make module.o from module.c and module from module.o.\nIt’s the same in the kitchen.\n1 salsa: chopped-tomato chopped-onion chopped-chilli Some things don’t need to be written as rules. Even if you’ve never seen a chilli before, you already know to get chopped chilli from chilli: you chop it with a knife. And you already know that to make a sauce from chopped ingredients: you mix them.\nParallel execution It’s possible to configure make to run jobs in parallel with the -j flag, for example -j4 says run up to four things at once, presumably because you have four CPU cores available. The following process can be sped up on two cores:\n1 myprogram: main.o module.o This is because building main.o and module.o don’t depend on each other so can each be built immediately, as soon as a CPU core is available.\nIt’s the same in the kitchen. Instead of CPU cores you have burners, ovens, toasters etc. The following can be executed in parallel given one toaster and one hob:\n1 beans-on-toast: warm-beans toasted-bread Cooking isn’t a script Before I could cook myself, I used to marvel at the ability of experienced cooks to not only reproduce a dish from memory, but to seemingly make it up as they went along. To observe it would appear the script was different every time, but the result was always the same!\nNow I realise how it’s possible: they weren’t memorising scripts. That would be far too hard. Imagine the hundreds of recipes and thousands of steps that would need to be remembered. Instead, human minds have a remarkable ability to organise this stuff, and I think it looks like one giant Makefile. We develop implicit rules far more comprehensive than those of make. Complex recipes are integrated by taking advantage of the redundancy in multiple layers of existing rules.\nWe probably even have a default target or, in English, a favourite comfort dish.\nWhen reading recipes they are almost always written in imperative style. My approach is to read it once through and assimilate it into my global Makefile before executing it. I don’t think it’s a good idea to execute any recipe from top to bottom without reading it first. I’ll often scribble down a recipe into a pseudo-Makefile format and take that into the kitchen rather than the original text.\nFor the record, I don’t actually write down recipes in anything close to a strict Makefile format but, just for fun, here’s what I think a Margherita pizza recipe looks like:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 margherita-pizza: cooked-margherita-pizza basil Add basil to top of pizza cooked-margherita-pizza: pizza-base tomato-sauce cheese Spread sauce on base and top with cheese, bake in oven pizza-base: pizza-dough Stretch dough into thin circular disc pizza-dough: flour water salt yeast Combine ingredients, knead, prove for many hours tomato-sauce: tomato Peel and chop tomatoes ","wordCount":"881","inLanguage":"en","datePublished":"2023-08-03T00:00:00Z","dateModified":"2023-08-03T00:00:00Z","author":[{"@type":"Person","name":"George Kettleborough"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://georgek.github.io/blog/posts/cooking-with-make/"},"publisher":{"@type":"Organization","name":"gpk blog","logo":{"@type":"ImageObject","url":"https://georgek.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://georgek.github.io/blog/ accesskey=h title="gpk blog (Alt + H)">gpk blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://georgek.github.io/blog/categories/ title=categories><span>categories</span></a></li><li><a href=https://georgek.github.io/blog/tags/ title=tags><span>tags</span></a></li><li><a href=https://georgek.github.io/blog/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://georgek.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://georgek.github.io/blog/posts/>Posts</a></div><h1 class=post-title>Cooking with Make</h1><div class=post-meta><span title='2023-08-03 00:00:00 +0000 UTC'>3 August 2023</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;George Kettleborough</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#making-food aria-label="Making food">Making food</a></li><li><a href=#implicit-rules aria-label="Implicit rules">Implicit rules</a></li><li><a href=#parallel-execution aria-label="Parallel execution">Parallel execution</a></li><li><a href=#cooking-isn-t-a-script aria-label="Cooking isn&amp;rsquo;t a script">Cooking isn&rsquo;t a script</a></li></ul></div></details></div><div class=post-content><p>I cook a lot of food from scratch and it occurred to me one day that the way I
understand and assimilate recipes is very similar to how <code>make</code> works.</p><p>So, in case you don&rsquo;t know, <code>make</code> is a tool used to build executable software from
source code. Building software often involves several steps such as translation,
compilation, linking and bundling. The process required for a particular project is
describe in a <code>Makefile</code> but, here&rsquo;s the thing, it isn&rsquo;t described imperatively, it&rsquo;s
described <em>declaratively</em>.</p><p>Let&rsquo;s look at an example:</p><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=display:flex><span><span style=color:#268bd2>myprogram</span><span style=color:#719e07>:</span> code.c
</span></span><span style=display:flex><span>      gcc code.c -o myprogram
</span></span></code></pre></td></tr></table></div></div><p>In the example <code>myprogram</code> is a <strong>target</strong> and <code>code.c</code> is a <strong>prerequisite</strong>. The target
is what <code>make</code> is going to, well, make. The prerequisite is what is required before we
can make it. In this case, the prerequisite is source code, so is always present and
satisfied.</p><p>The second line tells make <em>how</em> to make the target from the prerequisite (OK, this bit
is imperative, but we have to do <em>something</em>). In this case, we run a C compiler.</p><p>In this second example, more than one step is required to build the target:</p><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=display:flex><span><span style=color:#268bd2>myprogram</span><span style=color:#719e07>:</span> module.o
</span></span><span style=display:flex><span>      gcc module.o -o myprogram
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>module.o</span><span style=color:#719e07>:</span> module.c
</span></span><span style=display:flex><span>      gcc -c module.c -o module.o
</span></span></code></pre></td></tr></table></div></div><p>Now we first require <code>module.o</code> and, in case it&rsquo;s not already present, we show how to
make <code>module.o</code> too which requires <code>module.c</code>, the source code.</p><h2 id=making-food>Making food<a hidden class=anchor aria-hidden=true href=#making-food>#</a></h2><p>So what does a food recipe look like in a <code>Makefile</code>? Here&rsquo;s how to make a basic
<a href=https://en.wikipedia.org/wiki/B%C3%A9chamel_sauce>béchamel sauce</a>:</p><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=display:flex><span><span style=color:#268bd2>béchamel</span><span style=color:#719e07>:</span> milk roux
</span></span><span style=display:flex><span>      Gradually incorporate milk into roux, whisking continuously
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>roux</span><span style=color:#719e07>:</span> butter flour
</span></span><span style=display:flex><span>      Combine equal parts melted butter and flour into smooth paste
</span></span></code></pre></td></tr></table></div></div><p>We could easily extend this file to include higher-level targets, like a <a href=https://en.wikipedia.org/wiki/Mornay_sauce>Mornay sauce</a>:</p><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=display:flex><span><span style=color:#268bd2>mornay</span><span style=color:#719e07>:</span> béchamel grated-cheese
</span></span><span style=display:flex><span>      Add grated cheese to warm sauce
</span></span></code></pre></td></tr></table></div></div><p>More complex recipes are then natural:</p><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=display:flex><span><span style=color:#268bd2>cauliflower-cheese</span><span style=color:#719e07>:</span> mornay boiled-cauliflower
</span></span><span style=display:flex><span>      Combine sauce and boiled cauliflower
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>boilded-cauliflower</span><span style=color:#719e07>:</span> cauliflower
</span></span><span style=display:flex><span>      Separate cauliflower and boil in salted water
</span></span></code></pre></td></tr></table></div></div><h2 id=implicit-rules>Implicit rules<a hidden class=anchor aria-hidden=true href=#implicit-rules>#</a></h2><p>A perhaps lesser-known feature of <code>make</code> is that it contains implicit rules. That is,
<code>make</code> already knows how to make some things, mostly around C compilation. These aren&rsquo;t
as often used today, probably because C is no longer the only language in town.</p><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=display:flex><span><span style=color:#268bd2>module</span><span style=color:#719e07>:</span> module.o
</span></span></code></pre></td></tr></table></div></div><p>This is a valid <code>Makefile</code>. This works because <code>make</code> already knows how to make
<code>module.o</code> from <code>module.c</code> and <code>module</code> from <code>module.o</code>.</p><p>It&rsquo;s the same in the kitchen.</p><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=display:flex><span><span style=color:#268bd2>salsa</span><span style=color:#719e07>:</span> chopped-tomato chopped-onion chopped-chilli
</span></span></code></pre></td></tr></table></div></div><p>Some things don&rsquo;t need to be written as rules. Even if you&rsquo;ve never seen a chilli
before, you already know to get chopped chilli from chilli: you chop it with a knife.
And you already know that to make a sauce from chopped ingredients: you mix them.</p><h2 id=parallel-execution>Parallel execution<a hidden class=anchor aria-hidden=true href=#parallel-execution>#</a></h2><p>It&rsquo;s possible to configure <code>make</code> to run jobs in parallel with the <code>-j</code> flag, for
example <code>-j4</code> says run up to four things at once, presumably because you have four CPU
cores available. The following process can be sped up on two cores:</p><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=display:flex><span><span style=color:#268bd2>myprogram</span><span style=color:#719e07>:</span> main.o module.o
</span></span></code></pre></td></tr></table></div></div><p>This is because building <code>main.o</code> and <code>module.o</code> don&rsquo;t depend on each other so can each
be built immediately, as soon as a CPU core is available.</p><p>It&rsquo;s the same in the kitchen. Instead of CPU cores you have burners, ovens, toasters
etc. The following can be executed in parallel given one toaster and one hob:</p><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=display:flex><span><span style=color:#268bd2>beans-on-toast</span><span style=color:#719e07>:</span> warm-beans toasted-bread
</span></span></code></pre></td></tr></table></div></div><h2 id=cooking-isn-t-a-script>Cooking isn&rsquo;t a script<a hidden class=anchor aria-hidden=true href=#cooking-isn-t-a-script>#</a></h2><p>Before I could cook myself, I used to marvel at the ability of experienced cooks to not
only reproduce a dish from memory, but to seemingly make it up as they went along. To
observe it would appear the script was different every time, but the result was always
the same!</p><p>Now I realise how it&rsquo;s possible: they weren&rsquo;t memorising scripts. That would be far too
hard. Imagine the hundreds of recipes and thousands of steps that would need to be
remembered. Instead, human minds have a remarkable ability to organise this stuff, and
I think it looks like one giant <code>Makefile</code>. We develop implicit rules far more
comprehensive than those of <code>make</code>. Complex recipes are integrated by taking advantage
of the redundancy in multiple layers of existing rules.</p><p>We probably even have a default target or, in English, a favourite comfort dish.</p><p>When reading recipes they are almost always written in imperative style. My approach is
to read it once through and assimilate it into my global <code>Makefile</code> before executing
it. I don&rsquo;t think it&rsquo;s a good idea to execute any recipe from top to bottom without
reading it first. I&rsquo;ll often scribble down a recipe into a pseudo-<code>Makefile</code> format and
take that into the kitchen rather than the original text.</p><p>For the record, I don&rsquo;t actually write down recipes in anything close to a strict
<code>Makefile</code> format but, just for fun, here&rsquo;s what I think a Margherita pizza recipe looks
like:</p><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=display:flex><span><span style=color:#268bd2>margherita-pizza</span><span style=color:#719e07>:</span> cooked-margherita-pizza basil
</span></span><span style=display:flex><span>      Add basil to top of pizza
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>cooked-margherita-pizza</span><span style=color:#719e07>:</span> pizza-base tomato-sauce cheese
</span></span><span style=display:flex><span>      Spread sauce on base and top with cheese, bake in oven
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>pizza-base</span><span style=color:#719e07>:</span> pizza-dough
</span></span><span style=display:flex><span>      Stretch dough into thin circular disc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>pizza-dough</span><span style=color:#719e07>:</span> flour water salt yeast
</span></span><span style=display:flex><span>      Combine ingredients, knead, prove <span style=color:#719e07>for</span> many hours
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>tomato-sauce</span><span style=color:#719e07>:</span> tomato
</span></span><span style=display:flex><span>      Peel and chop tomatoes
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://georgek.github.io/blog/tags/cooking/>cooking</a></li><li><a href=https://georgek.github.io/blog/tags/programming/>programming</a></li><li><a href=https://georgek.github.io/blog/tags/make/>make</a></li><li><a href=https://georgek.github.io/blog/tags/makefile/>makefile</a></li><li><a href=https://georgek.github.io/blog/tags/declarative/>declarative</a></li></ul><nav class=paginav><a class=prev href=https://georgek.github.io/blog/posts/calibre-rootless-install/><span class=title>« Prev</span><br><span>Install Calibre without Root</span></a>
<a class=next href=https://georgek.github.io/blog/posts/emacs-arduino/><span class=title>Next »</span><br><span>Arduino Programming with Emacs</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Cooking with Make on twitter" href="https://twitter.com/intent/tweet/?text=Cooking%20with%20Make&amp;url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fcooking-with-make%2f&amp;hashtags=cooking%2cprogramming%2cmake%2cmakefile%2cdeclarative"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cooking with Make on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fcooking-with-make%2f&amp;title=Cooking%20with%20Make&amp;summary=Cooking%20with%20Make&amp;source=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fcooking-with-make%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cooking with Make on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fcooking-with-make%2f&title=Cooking%20with%20Make"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cooking with Make on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fcooking-with-make%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cooking with Make on whatsapp" href="https://api.whatsapp.com/send?text=Cooking%20with%20Make%20-%20https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fcooking-with-make%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cooking with Make on telegram" href="https://telegram.me/share/url?text=Cooking%20with%20Make&amp;url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fcooking-with-make%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://georgek.github.io/blog/>gpk blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>