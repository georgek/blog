<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Working on Multiple Web Projects with Docker Compose and Traefik | gpk blog</title><meta name=keywords content="programming,networking,web,development,traefik,docker,docker-compose"><meta name=description content="Docker Compose is a brilliant tool for bringing up local development environments for web projects. But working with multiple projects can be a pain due to clashes. For example, all projects want to listen to port 80 (or perhaps one of the super common higher ones like 8000 etc.). This forces developers to only bring one project up at a time, or hack the compose files to change the port numbers."><meta name=author content="George Kettleborough"><link rel=canonical href=https://georgek.github.io/blog/posts/multiple-web-projects-traefik/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.da26d85385b0fdeb8a2a69a77b648162de015c52980d8290ae1e611e42078a4c.css integrity="sha256-2ibYU4Ww/euKKmmne2SBYt4BXFKYDYKQrh5hHkIHikw=" rel="preload stylesheet" as=style><link rel=icon href=https://georgek.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://georgek.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://georgek.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://georgek.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://georgek.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta name=google-site-verification content="0kCOfXcz_aAJKh_eZglpQdpUUfE2IqecYZesW3oUOJo"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Lora:ital@0;1&family=Vollkorn:ital,wght@0,800;1,800&display=swap" rel=stylesheet><meta property="og:title" content="Working on Multiple Web Projects with Docker Compose and Traefik"><meta property="og:description" content="Docker Compose is a brilliant tool for bringing up local development environments for web projects. But working with multiple projects can be a pain due to clashes. For example, all projects want to listen to port 80 (or perhaps one of the super common higher ones like 8000 etc.). This forces developers to only bring one project up at a time, or hack the compose files to change the port numbers."><meta property="og:type" content="article"><meta property="og:url" content="https://georgek.github.io/blog/posts/multiple-web-projects-traefik/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-02T21:07:29+01:00"><meta property="article:modified_time" content="2023-10-02T21:07:29+01:00"><meta property="og:site_name" content="gpk blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Working on Multiple Web Projects with Docker Compose and Traefik"><meta name=twitter:description content="Docker Compose is a brilliant tool for bringing up local development environments for web projects. But working with multiple projects can be a pain due to clashes. For example, all projects want to listen to port 80 (or perhaps one of the super common higher ones like 8000 etc.). This forces developers to only bring one project up at a time, or hack the compose files to change the port numbers."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://georgek.github.io/blog/posts/"},{"@type":"ListItem","position":2,"name":"Working on Multiple Web Projects with Docker Compose and Traefik","item":"https://georgek.github.io/blog/posts/multiple-web-projects-traefik/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Working on Multiple Web Projects with Docker Compose and Traefik","name":"Working on Multiple Web Projects with Docker Compose and Traefik","description":"Docker Compose is a brilliant tool for bringing up local development environments for web projects. But working with multiple projects can be a pain due to clashes. For example, all projects want to listen to port 80 (or perhaps one of the super common higher ones like 8000 etc.). This forces developers to only bring one project up at a time, or hack the compose files to change the port numbers.","keywords":["programming","networking","web","development","traefik","docker","docker-compose"],"articleBody":" Docker Compose is a brilliant tool for bringing up local development environments for web projects. But working with multiple projects can be a pain due to clashes. For example, all projects want to listen to port 80 (or perhaps one of the super common higher ones like 8000 etc.). This forces developers to only bring one project up at a time, or hack the compose files to change the port numbers.\nRecently I've found a way that makes managing these more enjoyable.\nA single project with Docker Compose I use docker compose to manage local development instances of these projects. A typical compose file for a web project might look like this:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # proj/compose.yaml services: db: image: \"postgres\" environment: POSTGRES_DB: \"proj\" POSTGRES_USER: \"user\" POSTGRES_PASSWORD: \"pass\" web: build: . depends_on: - \"db\" environment: DATABASE_URL: \"postgres://user:pass@db/proj\" ports: - \"8000:80\" Note the very last line. This is where we map port 8000 from the host to port 80 of the container such that the service can be accessed via http://127.0.0.1:8000.\nThis works quite well for a single project, but it suffers from a couple of problems if you work on multiple projects:\nIt doesn't scale. If I want to run another project at the same time, I'll have to use a different port number, maybe 8001, then 8002 etc., What if that compose.yaml file is checked in as part of the project? Does the whole team have to agree on a set of port numbers to use for each project? Using overrides for multiple projects Fortunately Docker Compose does have a solution for (2) in the form of the compose.override.yaml file. This file will be automatically be merged into the compose.yaml without any extra configuration.\nUnlike some other guides (including the official docs) concerning this file, I prefer to not check compose.override.yaml into version control and instead add it to the .gitignore file. Adding it to version control completely defeats the purpose of it: to allow individual developers to override the standard compose file.\nSo, with this in mind, I no longer expose any ports by default in compose.yaml because I don't know what will be convenient for each developer. This set up might look like this:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # compose.yaml services: db: image: \"postgres\" environment: POSTGRES_DB: \"proj\" POSTGRES_USER: \"user\" POSTGRES_PASSWORD: \"pass\" web: build: . depends_on: - \"db\" environment: DATABASE_URL: \"postgres://user:pass@db/proj\" 1 2 3 4 5 # compose.override.yaml (to be created by each developer) services: web: ports: - \"8000:80\" Using Traefik So now each developer can pick their own port numbers for each project, but we can still do better than this. People aren't good at remembering numbers. We are much better at remembering names. Traefik is a free software edge router that can be used as a simple and super easy to configure reverse-proxy in container-based set ups.\nUsing Docker, Traefik can automatically discover services to create routes to. It uses container labels to further configure these routes. The following tiny example from the docs is illustrative:\n1 2 3 4 5 6 7 8 9 10 11 12 # traefik/compose.yaml services: reverse-proxy: image: traefik:v2.10 ports: - \"80:80\" volumes: - /var/run/docker.sock:/var/run/docker.sock whoami: image: traefik/whoami labels: - \"traefik.http.routers.whoami.rule=Host(`whoami.docker.localhost`)\" This starts two containers on the same docker network. The reverse proxy listens on port 80 and forwards traffic with a host header of \"whoami.docker.localhost\" to the whoami service. Traefik guesses which port to send it to whoami based on the ports exposed by the container.\nIf you haven't played with Traefik before it's worth going through the quick-start properly now then coming back to see how we can make this work for multiple projects.\nTraefik with multiple projects This doesn't quite solve our problem yet. We don't want all of our project inside one compose file. Luckily Traefik communicates with the Docker daemon directly and doesn't really care about the compose file, but you do need to make sure a few things are in order.\nFirstly, make a docker network especially for Traefik to communicate with other services that you want to expose, for example:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # traefik/compose.yaml services: reverse-proxy: image: traefik:v2.10 restart: unless-stopped command: --api.insecure=true --providers.docker ports: - \"80:80\" - \"8080:8080\" volumes: - \"/var/run/docker.sock:/var/run/docker.sock\" networks: - traefik networks: traefik: attachable: true name: traefik We create the network traefik and give it the name \"traefik\" (otherwise docker compose would scope it by project, e.g. \"traefik_traefik\"). We also allow other containers to attach to this network.\nThen in our compose.override.yaml file from above, instead of mapping ports, we do the following:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # proj/compose.override.yaml services: web: labels: - \"traefik.http.routers.proj.rule=Host(`proj.traefik.me`)\" - \"traefik.http.services.proj.loadbalancer.server.port=8000\" - \"traefik.docker.network=traefik\" networks: - default - traefik networks: traefik: external: true Now, after bringing up first the traefik project then your web project, you should be able to browse to http://proj.traefik.me/ in your web browser.\nThere's a few things going on here. First, we have declared the traefik network as an external network. This means compose won't manage it, but expects it to exist (so you must start your traefik composition first). Next we override the networks setting of web to make it part of the traefik network too. Note we also have to add the default network, otherwise it wouldn't be able to communicate with db and other services on its own default network.\nThe traefik.http.routers.proj.rule label configures Traefik to route HTTP traffic with the \"proj.traefik.me\" hostname to the container. The traffic.docker.network label is necessary because web is on two networks. Finally, we set traefik.http.services.proj.loadbalancer.server.port for completeness, just in case your container needs a different port mapping than the port it is set to expose, or if it exposes multiple ports.\nThere is one final piece of magic: the \"traefik.me\" hostname. What is that? You can read about it at http://traefik.me/. Essentially it is a DNS service that resolves to any IP address that you want, but by default it resolves .traefik.me to 127.0.0.1. There are other services like this including https://sslip.io/ and https://nip.io/.\nNow, because we don't need to define any ports at all, it is possible to take advantage of a newish compose feature and reinstate the ports in the original compose.yaml file for those developers who don't want to set up Traefik for themselves. So our final configuration looks like this:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # compose.yaml services: db: image: \"postgres\" environment: POSTGRES_DB: \"proj\" POSTGRES_USER: \"user\" POSTGRES_PASSWORD: \"pass\" web: build: . depends_on: - \"db\" environment: DATABASE_URL: \"postgres://user:pass@db/proj\" ports: - \"8000:80\" 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # compose.override.yaml (to be created by each developer) services: web: labels: - \"traefik.http.routers.proj.rule=Host(`proj.traefik.me`)\" - \"traefik.http.services.proj.loadbalancer.server.port=8000\" - \"traefik.docker.network=traefik\" networks: - default - traefik ports: !reset [] networks: traefik: external: true The !reset [] tag sets the ports back to empty; you can read about it here. Note that unfortunately it can't be used to set new ports, only reset them to default (you would have to use two layers of override file to set new ports). The !reset tag requires a fairly recent version of docker compose, at least greater than 2.18.0.\nA final note: you can check that these overrides are working correctly by running docker compose config.\nConclusion By leveraging both the compose.override.yaml file and Traefik it's easy to run multiple web projects on your development system at the same time and have easy to remember names to access them all. Each developer is free to run as many as they want and create their own easily-manageable configurations. Traefik and traefik.me can also be used to allow other developers on your network to easily access your local development instances with no DNS configuration required.\nIt's a shame that the docs instruct people to use the override file for a distributed developer config rather than let individual developers use it, but hopefully it's not too hard to remove this file from repos if already present.\n","wordCount":"1373","inLanguage":"en","datePublished":"2023-10-02T21:07:29+01:00","dateModified":"2023-10-02T21:07:29+01:00","author":{"@type":"Person","name":"George Kettleborough"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://georgek.github.io/blog/posts/multiple-web-projects-traefik/"},"publisher":{"@type":"Organization","name":"gpk blog","logo":{"@type":"ImageObject","url":"https://georgek.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://georgek.github.io/blog/ accesskey=h title="gpk blog (Alt + H)">gpk blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://georgek.github.io/blog/categories/ title=categories><span>categories</span></a></li><li><a href=https://georgek.github.io/blog/tags/ title=tags><span>tags</span></a></li><li><a href=https://georgek.github.io/blog/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://georgek.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://georgek.github.io/blog/posts/>Posts</a></div><h1 class=post-title>Working on Multiple Web Projects with Docker Compose and Traefik</h1><div class=post-meta><span title='2023-10-02 21:07:29 +0100 +0100'>2 October 2023</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;George Kettleborough</div></header><div class=post-content><p>Docker Compose is a brilliant tool for bringing up local development environments for
web projects. But working with multiple projects can be a pain due to clashes. For
example, all projects want to listen to port 80 (or perhaps one of the super common
higher ones like 8000 etc.). This forces developers to only bring one project up at a
time, or hack the compose files to change the port numbers.</p><p>Recently I've found a way that makes managing these more enjoyable.</p><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>A single project with Docker Compose</h2><div id=outline-text-headline-1 class=outline-text-2><p>I use <a href=https://docs.docker.com/compose/>docker compose</a> to manage local development instances of these projects. A typical
compose file for a web project might look like this:</p><div class="src src-yaml"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">17
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#586e75># proj/compose.yaml</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>db</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>image</span>: <span style=color:#2aa198>&#34;postgres&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#268bd2>POSTGRES_DB</span>: <span style=color:#2aa198>&#34;proj&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>POSTGRES_USER</span>: <span style=color:#2aa198>&#34;user&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>POSTGRES_PASSWORD</span>: <span style=color:#2aa198>&#34;pass&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>web</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>build</span>: .
</span></span><span style=display:flex><span>    <span style=color:#268bd2>depends_on</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;db&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#268bd2>DATABASE_URL</span>: <span style=color:#2aa198>&#34;postgres://user:pass@db/proj&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;8000:80&#34;</span></span></span></code></pre></td></tr></table></div></div></div><p>Note the very last line. This is where we map port 8000 from the host to port 80 of the
container such that the service can be accessed via <code>http://127.0.0.1:8000</code>.</p><p>This works quite well for a single project, but it suffers from a couple of problems if
you work on multiple projects:</p><ol><li>It doesn't scale. If I want to run another project at the same time, I'll have to
use a different port number, maybe 8001, then 8002 etc.,</li><li>What if that <code>compose.yaml</code> file is checked in as part of the project? Does the whole
team have to agree on a set of port numbers to use for each project?</li></ol></div></div><div id=outline-container-headline-2 class=outline-2><h2 id=headline-2>Using overrides for multiple projects</h2><div id=outline-text-headline-2 class=outline-text-2><p>Fortunately Docker Compose does have a solution for (2) in the form of the
<code>compose.override.yaml</code> file. This file will be automatically be <a href=https://docs.docker.com/compose/multiple-compose-files/merge/>merged</a> into the
<code>compose.yaml</code> without any extra configuration.</p><p>Unlike some other guides (including the official <a href=https://docs.docker.com/compose/multiple-compose-files/merge/#example>docs</a>) concerning this file, I prefer to
<strong>not</strong> check <code>compose.override.yaml</code> into version control and instead add it to the
<code>.gitignore</code> file. Adding it to version control completely defeats the purpose of it: to
allow individual developers to override the standard compose file.</p><p>So, with this in mind, I no longer expose any ports by default in <code>compose.yaml</code> because
I don't know what will be convenient for each developer. This set up might look like
this:</p><div class="src src-yaml"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#586e75># compose.yaml</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>db</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>image</span>: <span style=color:#2aa198>&#34;postgres&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#268bd2>POSTGRES_DB</span>: <span style=color:#2aa198>&#34;proj&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>POSTGRES_USER</span>: <span style=color:#2aa198>&#34;user&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>POSTGRES_PASSWORD</span>: <span style=color:#2aa198>&#34;pass&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>web</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>build</span>: .
</span></span><span style=display:flex><span>    <span style=color:#268bd2>depends_on</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;db&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#268bd2>DATABASE_URL</span>: <span style=color:#2aa198>&#34;postgres://user:pass@db/proj&#34;</span></span></span></code></pre></td></tr></table></div></div></div><div class="src src-yaml"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#586e75># compose.override.yaml (to be created by each developer)</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>web</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;8000:80&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div></div><div id=outline-container-headline-3 class=outline-2><h2 id=headline-3>Using Traefik</h2><div id=outline-text-headline-3 class=outline-text-2><p>So now each developer can pick their own port numbers for each project, but we can still
do better than this. People aren't good at remembering numbers. We are much better at
remembering names. <a href=https://doc.traefik.io/traefik/>Traefik</a> is a free software edge router that can be used as a simple
and super easy to configure reverse-proxy in container-based set ups.</p><p>Using Docker, Traefik can automatically discover services to create routes to. It uses
container labels to further configure these routes. The following tiny example from the
<a href=https://doc.traefik.io/traefik/getting-started/quick-start/>docs</a> is illustrative:</p><div class="src src-yaml"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#586e75># traefik/compose.yaml</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>reverse-proxy</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>image</span>: traefik:v2.10
</span></span><span style=display:flex><span>    <span style=color:#268bd2>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;80:80&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>volumes</span>:
</span></span><span style=display:flex><span>      - /var/run/docker.sock:/var/run/docker.sock
</span></span><span style=display:flex><span>  <span style=color:#268bd2>whoami</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>image</span>: traefik/whoami
</span></span><span style=display:flex><span>    <span style=color:#268bd2>labels</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;traefik.http.routers.whoami.rule=Host(`whoami.docker.localhost`)&#34;</span></span></span></code></pre></td></tr></table></div></div></div><p>This starts two containers on the same docker network. The reverse proxy listens on
port 80 and forwards traffic with a host header of "whoami.docker.localhost" to the
<code>whoami</code> service. Traefik guesses which port to send it to <code>whoami</code> based on the ports
exposed by the container.</p><p>If you haven't played with Traefik before it's worth going through the <a href=https://doc.traefik.io/traefik/getting-started/quick-start/>quick-start</a>
properly now then coming back to see how we can make this work for multiple projects.</p></div></div><div id=outline-container-headline-4 class=outline-2><h2 id=headline-4>Traefik with multiple projects</h2><div id=outline-text-headline-4 class=outline-text-2><p>This doesn't quite solve our problem yet. We don't want all of our project inside one
compose file. Luckily Traefik communicates with the Docker daemon directly and doesn't
really care about the compose file, but you do need to make sure a few things are in
order.</p><p>Firstly, make a docker network especially for Traefik to communicate with other services
that you want to expose, for example:</p><div class="src src-yaml"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#586e75># traefik/compose.yaml</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>reverse-proxy</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>image</span>: traefik:v2.10
</span></span><span style=display:flex><span>    <span style=color:#268bd2>restart</span>: unless-stopped
</span></span><span style=display:flex><span>    <span style=color:#268bd2>command</span>: --api.insecure=true --providers.docker
</span></span><span style=display:flex><span>    <span style=color:#268bd2>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;80:80&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;8080:8080&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;/var/run/docker.sock:/var/run/docker.sock&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>networks</span>:
</span></span><span style=display:flex><span>      - traefik
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>networks</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>traefik</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>attachable</span>: <span style=color:#cb4b16>true</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>name</span>: traefik</span></span></code></pre></td></tr></table></div></div></div><p>We create the network <code>traefik</code> and give it the name "traefik" (otherwise docker compose
would scope it by project, e.g. "traefik_traefik"). We also allow other containers to
attach to this network.</p><p>Then in our <code>compose.override.yaml</code> file from above, instead of mapping ports, we do the
following:</p><div class="src src-yaml"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#586e75># proj/compose.override.yaml</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>web</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>labels</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;traefik.http.routers.proj.rule=Host(`proj.traefik.me`)&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;traefik.http.services.proj.loadbalancer.server.port=8000&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;traefik.docker.network=traefik&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>networks</span>:
</span></span><span style=display:flex><span>      - default
</span></span><span style=display:flex><span>      - traefik
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>networks</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>traefik</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>external</span>: <span style=color:#cb4b16>true</span></span></span></code></pre></td></tr></table></div></div></div><p>Now, after bringing up first the traefik project then your web project, you should be
able to browse to <a href=http://proj.traefik.me/>http://proj.traefik.me/</a> in your web browser.</p><p>There's a few things going on here. First, we have declared the <code>traefik</code> network as an
external network. This means compose won't manage it, but expects it to exist (so you
must start your traefik composition first). Next we override the <code>networks</code> setting of
<code>web</code> to make it part of the <code>traefik</code> network too. Note we also have to add the
<code>default</code> network, otherwise it wouldn't be able to communicate with <code>db</code> and other
services on its own default network.</p><p>The <code>traefik.http.routers.proj.rule</code> label configures Traefik to route HTTP traffic with
the "proj.traefik.me" hostname to the container. The <code>traffic.docker.network</code> label is
necessary because <code>web</code> is on two networks. Finally, we set
<code>traefik.http.services.proj.loadbalancer.server.port</code> for completeness, just in case
your container needs a different port mapping than the port it is set to expose, or if
it exposes multiple ports.</p><p>There is one final piece of magic: the "traefik.me" hostname. What is that? You can
read about it at <a href=http://traefik.me/>http://traefik.me/</a>. Essentially it is a DNS service that resolves to
any IP address that you want, but by default it resolves <code>&lt;xxx>.traefik.me</code> to
<code>127.0.0.1</code>. There are other services like this including <a href=https://sslip.io/>https://sslip.io/</a> and
<a href=https://nip.io/>https://nip.io/</a>.</p><p>Now, because we don't need to define any ports at all, it is possible to take advantage
of a newish compose feature and reinstate the ports in the original <code>compose.yaml</code> file
for those developers who don't want to set up Traefik for themselves. So our final
configuration looks like this:</p><div class="src src-yaml"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">17
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#586e75># compose.yaml</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>db</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>image</span>: <span style=color:#2aa198>&#34;postgres&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#268bd2>POSTGRES_DB</span>: <span style=color:#2aa198>&#34;proj&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>POSTGRES_USER</span>: <span style=color:#2aa198>&#34;user&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>POSTGRES_PASSWORD</span>: <span style=color:#2aa198>&#34;pass&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>web</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>build</span>: .
</span></span><span style=display:flex><span>    <span style=color:#268bd2>depends_on</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;db&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#268bd2>DATABASE_URL</span>: <span style=color:#2aa198>&#34;postgres://user:pass@db/proj&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;8000:80&#34;</span></span></span></code></pre></td></tr></table></div></div></div><div class="src src-yaml"><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#586e75># compose.override.yaml (to be created by each developer)</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>web</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>labels</span>:
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;traefik.http.routers.proj.rule=Host(`proj.traefik.me`)&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;traefik.http.services.proj.loadbalancer.server.port=8000&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#2aa198>&#34;traefik.docker.network=traefik&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>networks</span>:
</span></span><span style=display:flex><span>      - default
</span></span><span style=display:flex><span>      - traefik
</span></span><span style=display:flex><span>    <span style=color:#268bd2>ports</span>: !reset []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>networks</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>traefik</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>external</span>: <span style=color:#cb4b16>true</span></span></span></code></pre></td></tr></table></div></div></div><p>The <code>!reset []</code> tag sets the ports back to empty; you can read about it <a href=https://docs.docker.com/compose/compose-file/13-merge/#reset-value>here</a>. Note that
unfortunately it can't be used to set <em>new</em> ports, only reset them to default (you would
have to use two layers of override file to set new ports). The <code>!reset</code> tag requires a
fairly recent version of docker compose, at least greater than 2.18.0.</p><p>A final note: you can check that these overrides are working correctly by running
<code>docker compose config</code>.</p></div></div><div id=outline-container-headline-5 class=outline-2><h2 id=headline-5>Conclusion</h2><div id=outline-text-headline-5 class=outline-text-2><p>By leveraging both the <code>compose.override.yaml</code> file and Traefik it's easy to run
multiple web projects on your development system at the same time and have easy to
remember names to access them all. Each developer is free to run as many as they want
and create their own easily-manageable configurations. Traefik and traefik.me can also
be used to allow other developers on your network to easily access your local
development instances with no DNS configuration required.</p><p>It's a shame that the docs instruct people to use the override file for a distributed
developer config rather than let individual developers use it, but hopefully it's not
too hard to remove this file from repos if already present.</p></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://georgek.github.io/blog/tags/programming/>programming</a></li><li><a href=https://georgek.github.io/blog/tags/networking/>networking</a></li><li><a href=https://georgek.github.io/blog/tags/web/>web</a></li><li><a href=https://georgek.github.io/blog/tags/development/>development</a></li><li><a href=https://georgek.github.io/blog/tags/traefik/>traefik</a></li><li><a href=https://georgek.github.io/blog/tags/docker/>docker</a></li></ul><nav class=paginav><a class=next href=https://georgek.github.io/blog/posts/pfsense-unbound-private/><span class=title>Next »</span><br><span>Resolving Private IP Addresses with pfSense DNS Resolver</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Working on Multiple Web Projects with Docker Compose and Traefik on twitter" href="https://twitter.com/intent/tweet/?text=Working%20on%20Multiple%20Web%20Projects%20with%20Docker%20Compose%20and%20Traefik&amp;url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fmultiple-web-projects-traefik%2f&amp;hashtags=programming%2cnetworking%2cweb%2cdevelopment%2ctraefik%2cdocker"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Working on Multiple Web Projects with Docker Compose and Traefik on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fmultiple-web-projects-traefik%2f&amp;title=Working%20on%20Multiple%20Web%20Projects%20with%20Docker%20Compose%20and%20Traefik&amp;summary=Working%20on%20Multiple%20Web%20Projects%20with%20Docker%20Compose%20and%20Traefik&amp;source=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fmultiple-web-projects-traefik%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Working on Multiple Web Projects with Docker Compose and Traefik on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fmultiple-web-projects-traefik%2f&title=Working%20on%20Multiple%20Web%20Projects%20with%20Docker%20Compose%20and%20Traefik"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Working on Multiple Web Projects with Docker Compose and Traefik on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fmultiple-web-projects-traefik%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Working on Multiple Web Projects with Docker Compose and Traefik on whatsapp" href="https://api.whatsapp.com/send?text=Working%20on%20Multiple%20Web%20Projects%20with%20Docker%20Compose%20and%20Traefik%20-%20https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fmultiple-web-projects-traefik%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Working on Multiple Web Projects with Docker Compose and Traefik on telegram" href="https://telegram.me/share/url?text=Working%20on%20Multiple%20Web%20Projects%20with%20Docker%20Compose%20and%20Traefik&amp;url=https%3a%2f%2fgeorgek.github.io%2fblog%2fposts%2fmultiple-web-projects-traefik%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://georgek.github.io/blog/>gpk blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>